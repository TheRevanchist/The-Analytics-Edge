teamRank = c(1,2,3,3,4,4,4,4,5,5)
wins2012 = c(94, 88, 95, 88, 93, 94, 98, 97, 93, 94)
wins2013 = c(97, 97, 92, 93, 92, 96, 94, 96, 92, 90)
cor(teamRank, wins2012)
cor(teamRank, wins2013)
data(state)
statedata = cbind(data.frame(state.x77), state.abb, state.area, state.center,  state.division, state.name, state.region)
plot(statedata$x, statedata$y)
summary(statedata)
tapply(statedata$HS.Grad, statedata$state.region, mean)
boxplot(statedata$Murder~statedata$state.region)
NorthEast = subset(statedata, state.region == "Northeast")
Northeast
NorthEast$Murder
NorthEast
Model1 = lm(Income~., data = statedata)
Model1 = lm(LifeExp~., data = statedata)
Model1 = lm(Life.Exp~., data = statedata)
Model1
summary(Model1)
LinReg = lm(Life.Exp ~ Population + Income + Illiteracy + Murder + HS.Grad + Frost + Area, data=statedata)
LinReg
plot(statedata$Income, statedata$Life.Exp)
model2 = step(LinReg)
summary(model2)
summary(statedata)
summary(LinReg)
sort(predict(LinReg))
which.min(statedata$Life.Exp)
sort(abs(model2$residuals))
setwd("C:/Workbench/Online Courses/The Analytics Edge/Week 4")
census = read.csv("census.csv")
set.seed(2000)
library(caTools)
spl = sample.split(census$over50k, SplitRatio = 0.6)
train = subset(census, spl == TRUE)
test = subset(census, spl == FALSE)
logMod = glm(over50k~., data = train, family = "binomial")
summary(logMod)
predictTrain = predict(logMod, type = "response")
predictTest = predict(logMod, newdata = test ,type = "response")
table(test$over50k, predictTest > 0.5)
(9051+1888)/nrow(test)
table(test$over50k)
9713/nrow(test)
library(ROCR)
PredictROCT = prediction(predictTest, test$over50k)
perf = performance(PredictROCT, "tpr", "fpr")
plot(perf)
as.numeric(performance(pred, "auc")@y.values)
as.numeric(performance(PredictROCT, "auc")@y.values)
library(rpart)
library(rpart.plot)
cart = rpart(over50k~., data = train, method = "class")
prp(cart)
predTree = predict(cart, newdata = test, method = "class")
table(test$over50k, predTree)
predTree = predict(cart, newdata = test)
PredictCART = predict(cart, newdata = test, type = "class")
table(test$over50k, PredictCART)
(9243+1596)/nrow(test)
pred = prediction(PredictCART[2], test$over50k)
pred = prediction(PredictCART[,2], test$over50k)
set.seed(1)
trainSmall = train[sample(nrow(train), 2000), ]
library(randomForest)
randForest = randomForest(over50k~., data = trainSmall)
PredictForest = predict(randForest, newdata = test)
table(test$over50k, PredictForest)
(9614+1050)/nrow(test)
vu = varUsed(randForest, count=TRUE)
vusorted = sort(vu, decreasing = FALSE, index.return = TRUE)
dotchart(vusorted$x, names(MODEL$forest$xlevels[vusorted$ix]))
dotchart(vusorted$x, names(randForest$forest$xlevels[vusorted$ix]))
varImpPlot(randForest)
